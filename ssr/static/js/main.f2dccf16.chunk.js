(this.webpackJsonprobot_business_manage=this.webpackJsonprobot_business_manage||[]).push([[1],{227:function(e,r,t){"use strict";var n=t(37),o=t(75),a=t(74),c=t(25),s=t.n(c),i=(t(403),t(241)),u=t(159),d=(t(405),t(243)),p=t(233),l=t(72),f=window.fetch;window.fetch=function(e,r,t){var n=f(e,r),o=new Promise((function(e,r){setTimeout((function(){r(new Error("\u8bf7\u6c42\u8d85\u65f6\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"))}),3e3)}));return Promise.race([n,o])};var h=function(){function e(){Object(n.a)(this,e)}return Object(l.a)(e,[{key:"get",value:function(r,t){var n=t.params,o=t.headers,a=r;if(n){var c=[];Object.keys(n).forEach((function(e){return c.push("".concat(e,"=").concat(encodeURI(n[e])))})),-1===a.search(/\?/)?a+="?".concat(c.join("&")):a+="&".concat(c.join("&"))}var s=e.creatHeaders(o);return fetch(a,{method:"GET",headers:s}).then((function(r){return e.responseIntercept(r)})).catch((function(r){return e.processError({url:a,error:r})}))}},{key:"post",value:function(r,t){var n=t.params,o=t.headers,a=e.creatBody({headers:o,params:n}),c={method:"POST",headers:e.creatHeaders(o)};return a&&(c.body=a),fetch(r,c).then((function(r){return e.responseIntercept(r)})).catch((function(t){return e.processError({url:r,error:t})}))}},{key:"put",value:function(r,t){var n=t.params,o=t.headers,a=JSON.stringify(n)||"",c=e.creatHeaders(o);return fetch(r,{method:"PUT",headers:c,body:a}).then((function(r){return e.responseIntercept(r)})).catch((function(t){return e.processError({url:r,error:t})}))}},{key:"delete",value:function(r,t){var n=t.params,o=t.headers,a=JSON.stringify(n)||"",c=e.creatHeaders(o);return fetch(r,{method:"DELETE",headers:c,body:a}).then((function(r){return e.responseIntercept(r)})).catch((function(t){return e.processError({url:r,error:t})}))}}],[{key:"creatHeaders",value:function(e){var r={"Content-Type":"application/json"},t=sessionStorage.getItem("userInfo");return t&&(r=Object(p.a)({},r,{"x-token":JSON.parse(t).token})),e?Object.assign(r,e):r}},{key:"processError",value:function(e){var r=e.url,t=e.error;return d.a.error({message:"\u8bf7\u6c42\u9519\u8bef ".concat(r),description:"".concat(t)}),Promise.reject("\u7f51\u7edc\u8bf7\u6c42\u51fa\u9519\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")}},{key:"responseIntercept",value:function(){var e=Object(u.a)(s.a.mark((function e(r){var t,n,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(this.props,"props"),r){e.next=3;break}return e.abrupt("return",Promise.reject("\u8bf7\u6c42\u8fd4\u56de\u4e3a\u7a7a\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"));case 3:if(!r||!r.status){e.next=15;break}return r.url,t=r.status,e.next=7,r.json();case 7:if(n=e.sent,200!==t){e.next=14;break}return 200!==n.code&&i.a.error(n.message),10402===n.code&&(window.G_dispatch({type:"account/loginOut",payload:{}}),o=window.location.href.split("#")[0],window.location.href=o),e.abrupt("return",n);case 14:return e.abrupt("return",Promise.reject("\u8bf7\u6c42\u9519\u8bef ".concat(t)));case 15:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"creatBody",value:function(e){var r=e.headers,t=e.params;if(t){if("string"===typeof t)return t;if(r&&"application/x-www-form-urlencoded"===r["Content-Type"]){var n="";for(var o in t)"sysId"!==o&&(n=n+o+"="+t[o]+"&");return n+="sysId=qWechat"}return JSON.stringify(t)}return null}}]),e}(),v="https://177h27l110.iok.la/dss",m="";console.log("API_ENV",Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).API_ENV),m="test"===Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).API_ENV&&window.location.href.includes("192.168.1.24")?v:"test"===Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).API_ENV||"pro"===Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).API_ENV?"https://177h27l110.iok.la/dss":v;var O=function(e){Object(a.a)(t,e);var r=Object(o.a)(t);function t(){var e;Object(n.a)(this,t);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(e=r.call.apply(r,[this].concat(a))).test=function(r){var t=r.params,n=void 0===t?{}:t,o=r.headers,a=void 0===o?{}:o;return e.get(m+"/integratedmachine",{params:n,headers:a})},e.login=function(r){var t=r.params,n=void 0===t?{}:t,o=r.headers,a=void 0===o?{}:o;return e.post(m+"/user/login",{params:n,headers:a})},e}return t}(h);r.a=new O},244:function(e,r,t){},247:function(e,r,t){e.exports=t(473)},310:function(e,r){},401:function(e,r,t){},473:function(e,r,t){"use strict";t.r(r);var n=t(92),o=t.n(n),a=t(3),c=t(0),s=t.n(c),i=t(13),u=t(37),d=t(72),p=t(75),l=t(74),f=t(208),h=t.n(f),v=(t(244),s.a.lazy((function(){return Promise.all([t.e(0),t.e(5)]).then(t.bind(null,615))}))),m=s.a.lazy((function(){return Promise.all([t.e(0),t.e(4),t.e(6)]).then(t.bind(null,614))})),O=function(e){Object(l.a)(t,e);var r=Object(p.a)(t);function t(){return Object(u.a)(this,t),r.apply(this,arguments)}return Object(d.a)(t,[{key:"componentWillMount",value:function(){window.G_dispatch=this.props.dispatch,window.G_history=this.props.history}},{key:"render",value:function(){return s.a.createElement(c.Suspense,{fallback:s.a.createElement("div",{style:{width:"100%",height:"100%"}},"loading...")},s.a.createElement(h.a,null,s.a.createElement(i.Route,{path:"/",exact:!0,render:function(e){return s.a.createElement(m,e)}}),s.a.createElement(i.Route,{path:"/layout",render:function(e){return s.a.createElement(v,e)}}),s.a.createElement(i.Redirect,{to:"/"})))}}]),t}(s.a.Component),E=Object(n.connect)((function(){return{}}))(O);var _=function(e){var r=e.history;return s.a.createElement(i.Router,{history:r},s.a.createElement(i.Route,{path:"/",component:E}))};t(401),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var y=t(232),b=t(25),w=t.n(b),S=t(227),g={namespace:"account",state:{},effects:{login:w.a.mark((function e(r,t){var n,o,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.payload,r.callback,t.call,o=t.put,e.next=4,S.a.login({params:n});case 4:if(200!==(a=e.sent).code){e.next=9;break}return sessionStorage.setItem("userInfo",JSON.stringify(a.data)),e.next=9,o(i.routerRedux.push("/layout"));case 9:case"end":return e.stop()}}),e)})),loginOut:w.a.mark((function e(r,t){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(y.a)(r),t.call,n=t.put,e.next=4,n(i.routerRedux.push("/"));case 4:case"end":return e.stop()}}),e)}))},reducers:{}};var T=o()({history:Object(a.a)(),initialState:{},onError:function(e){console.log("dva_onError",e)}});T.model(g),T.router(_),T.start("#root"),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[247,2,3]]]);
//# sourceMappingURL=main.f2dccf16.chunk.js.map